{% extends "admin/base.html" %}

{% block title %}Mailout List - Admin{% endblock %}

{% block content %}
<h1>Mailouts</h1>
<div class="action-links">
    <a href="{{ url_for('create_mailout_form_admin') }}" class="button-link">Create New Mailout</a>
</div>
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Start Time</th>
            <th>End Time</th>
            <th>Message</th>
            <th>Phone Codes</th>
            <th>Tags</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for mailout in mailouts %}
        <tr>
            <td>{{ mailout.id }}</td>
            <td>{{ mailout.start_at.strftime('%Y-%m-%d %H:%M') if mailout.start_at else 'N/A' }}</td>
            <td>{{ mailout.finish_at.strftime('%Y-%m-%d %H:%M') if mailout.finish_at else 'N/A' }}</td>
            <td>{{ mailout.text_message | truncate(50) }}</td>
            <td>
                {% if mailout.phone_codes %}
                    {% for pc in mailout.phone_codes %}
                        <span class="tag">{{ pc.phone_code }}</span>
                    {% endfor %}
                {% else %}
                    N/A
                {% endif %}
            </td>
            <td>
                {% if mailout.tags %}
                    {% for tag in mailout.tags %}
                        <span class="tag">{{ tag.tag }}</span>
                    {% endfor %}
                {% else %}
                    N/A
                {% endif %}
            </td>
            <td class="action-links">
                <a href="{{ url_for('view_mailout_admin', mailout_id=mailout.id) if mailout.id else '#' }}">View</a> 
                <a href="{{ url_for('edit_mailout_form_admin', mailout_id=mailout.id) if mailout.id else '#' }}">Edit</a>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="7">No mailouts found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<style>
    .tag {
        display: inline-block;
        background-color: #e0e0e0;
        color: #333;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 0.85em;
        margin-right: 4px;
        margin-bottom: 4px;
    }
</style>

{% endblock %} 